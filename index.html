import tkinter as tk
import random
import math
import threading
import time
from tkinter import messagebox

class LoveApp:
    def __init__(self):
        self.root = tk.Tk()
        self.root.title("来自祝可的讯息")
        self.root.geometry("400x300")
        self.root.configure(bg='#fff5f7')
        
        self.label = tk.Label(self.root, text="做我女朋友好吗？✨", font=("Microsoft YaHei", 18), bg='#fff5f7', fg='#d63384')
        self.label.pack(pady=50)

        self.yes_btn = tk.Button(self.root, text="好呀", command=self.accept, width=10, bg='#ff4d7d', fg='white', font=("Microsoft YaHei", 12))
        self.yes_btn.place(x=100, y=180)

        self.no_btn = tk.Button(self.root, text="不要", command=self.move_no, width=10, bg='#bdc3c7', fg='white', font=("Microsoft YaHei", 12))
        self.no_btn.place(x=220, y=180)
        
        self.no_scale = 1.0

    def move_no(self):
        # 按钮变小
        self.no_scale -= 0.1
        if self.no_scale <= 0.2:
            self.no_btn.destroy() # 变太小就消失
            return
            
        new_font_size = int(12 * self.no_scale)
        self.no_btn.configure(font=("Microsoft YaHei", new_font_size))
        
        # 随机跳动
        nx = random.randint(50, 300)
        ny = random.randint(50, 250)
        self.no_btn.place(x=nx, y=ny)

    def accept(self):
        self.root.withdraw() # 隐藏主窗口
        self.show_hearts()

    def show_hearts(self):
        msgs = ["我爱你", "只喜欢你", "❤️", "祝可守护你", "余生请多指教"]
        # 爱心方程点位
        for i in range(80):
            t = (2 * math.pi / 80) * i
            x = 16 * math.sin(t) ** 3
            y = 13 * math.cos(t) - 5 * math.cos(2*t) - 2 * math.cos(3*t) - math.cos(4*t)
            
            # 屏幕坐标适配
            screen_x = x * 15 + 960 # 这里的960和440需根据对方屏幕调整
            screen_y = -y * 15 + 440
            
            t_pop = threading.Thread(target=self.pop_window, args=(screen_x, screen_y, random.choice(msgs)))
            t_pop.start()
            time.sleep(0.1)
        
        # 最后弹出一个大的
        messagebox.showinfo("祝可的真心", "太开心啦！❤️\n余生请多指教！\n—— 祝可")

    def pop_window(self, x, y, text):
        pop = tk.Toplevel()
        pop.geometry(f"120x60+{int(x)}+{int(y)}")
        pop.overrideredirect(True) # 去掉边框
        tk.Label(pop, text=text, bg='#ff85a2', fg='white', font=("Microsoft YaHei", 10, "bold")).pack(expand=True, fill='both')
        pop.attributes("-topmost", True)

if __name__ == "__main__":
    app = LoveApp()
    app.root.mainloop()
